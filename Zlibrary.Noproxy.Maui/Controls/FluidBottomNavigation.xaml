<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:Zlibrary.Noproxy.Maui.Controls"
             x:Class="Zlibrary.Noproxy.Maui.Controls.FluidBottomNavigation"
             x:Name="FluidNavigation">

    <ContentView.Resources>
        <controls:IndexToColorConverter x:Key="IndexToColorConverter" />
    </ContentView.Resources>

    <Grid HeightRequest="80" BackgroundColor="White">
        <!-- Background with shadow -->
        <Border BackgroundColor="White"
                StrokeThickness="0"
                Shadow="{Shadow Brush=Black, Opacity=0.1, Radius=10, Offset='0,-2'}">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="0" />
            </Border.StrokeShape>
        </Border>

        <!-- Fluid Animation Container -->
        <Grid HeightRequest="80"
              BackgroundColor="Transparent">

            <!-- Main Fluid Shape -->
            <Border x:Name="FluidShape"
                    WidthRequest="100"
                    HeightRequest="60"
                    BackgroundColor="#6C5CE7"
                    StrokeThickness="0"
                    HorizontalOptions="Start"
                    VerticalOptions="Start"
                    Margin="0,10,0,0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="30,30,30,30" />
                </Border.StrokeShape>
            </Border>

            <!-- Small Fluid Blobs -->
            <Ellipse x:Name="FluidBlob1"
                     Fill="#6C5CE7"
                     WidthRequest="20"
                     HeightRequest="20"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="10,50,0,0" />

            <Ellipse x:Name="FluidBlob2"
                     Fill="#6C5CE7"
                     WidthRequest="15"
                     HeightRequest="15"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="75,55,0,0" />

            <Ellipse x:Name="FluidBlob3"
                     Fill="#6C5CE7"
                     WidthRequest="12"
                     HeightRequest="12"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="45,58,0,0" />
        </Grid>

        <!-- Navigation Items -->
        <Grid ColumnDefinitions="*,*,*,*"
              HorizontalOptions="FillAndExpand"
              VerticalOptions="FillAndExpand">

            <!-- Home Tab -->
            <Grid Grid.Column="0" x:Name="HomeTab">
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnTabTapped" CommandParameter="0" />
                </Grid.GestureRecognizers>

                <!-- Home Icon using Path for exact match -->
                <Path x:Name="HomeIcon"
                      Data="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"
                      Fill="{Binding Source={x:Reference FluidNavigation}, Path=SelectedIndex, Converter={StaticResource IndexToColorConverter}, ConverterParameter='0'}"
                      WidthRequest="24"
                      HeightRequest="24"
                      HorizontalOptions="Center"
                      VerticalOptions="Center" />
            </Grid>

            <!-- Search Tab -->
            <Grid Grid.Column="1" x:Name="SearchTab">
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnTabTapped" CommandParameter="1" />
                </Grid.GestureRecognizers>

                <!-- Search Icon using Path for exact match -->
                <Path x:Name="SearchIcon"
                      Data="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                      Fill="{Binding Source={x:Reference FluidNavigation}, Path=SelectedIndex, Converter={StaticResource IndexToColorConverter}, ConverterParameter='1'}"
                      WidthRequest="24"
                      HeightRequest="24"
                      HorizontalOptions="Center"
                      VerticalOptions="Center" />
            </Grid>

            <!-- Heart Tab -->
            <Grid Grid.Column="2" x:Name="HeartTab">
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnTabTapped" CommandParameter="2" />
                </Grid.GestureRecognizers>

                <!-- Heart Icon using Path for exact match -->
                <Path x:Name="HeartIcon"
                      Data="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                      Fill="{Binding Source={x:Reference FluidNavigation}, Path=SelectedIndex, Converter={StaticResource IndexToColorConverter}, ConverterParameter='2'}"
                      WidthRequest="24"
                      HeightRequest="24"
                      HorizontalOptions="Center"
                      VerticalOptions="Center" />
            </Grid>

            <!-- Profile Tab -->
            <Grid Grid.Column="3" x:Name="ProfileTab">
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnTabTapped" CommandParameter="3" />
                </Grid.GestureRecognizers>

                <!-- Profile Icon using Path for exact match -->
                <Path x:Name="ProfileIcon"
                      Data="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                      Fill="{Binding Source={x:Reference FluidNavigation}, Path=SelectedIndex, Converter={StaticResource IndexToColorConverter}, ConverterParameter='3'}"
                      WidthRequest="24"
                      HeightRequest="24"
                      HorizontalOptions="Center"
                      VerticalOptions="Center" />
            </Grid>
        </Grid>
    </Grid>
</ContentView>
